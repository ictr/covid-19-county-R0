DATE = seq(20200901,20200929,1)
colnames(new_data[2:ncol(new_data)]) = DATE
View(new_data)
View(my_data)
View(new_data)
colnames(new_data) = c("county", DATE)
View(new_data)
new_data = melt(new_data)
View(new_data)
colnames(new_data)[2:3] = c("date", "positive")
View(new_data)
subset(my_data, my_data$county == "Austin" & my_data$date == 20200901)
my_data$positive[which(my_data$county == "Austin" & my_data$date == 20200901)]
for(i in 1:ncol(new_data)){
my_data$positive[which(my_data$county == new_data$county[i] & my_data$date == new_data$date[i])] = new_data$positive[i]
}
my_data$positive[which(my_data$county == new_data$county[i] & my_data$date == new_data$date[i])]
new_data$county[1]
my_data$county == new_data$county[i]
my_data$date == new_data$date[i]
my_data$date = as.character(my_data$date)
View(my_data)
new_data$date = as.character(new_data$date)
View(new_data)
for(i in 1:ncol(new_data)){
my_data$positive[which(my_data$county == new_data$county[i] & my_data$date == new_data$date[i])] = new_data$positive[i]
}
View(my_data)
for(i in 1:nrow(new_data)){
my_data$positive[which(my_data$county == new_data$county[i] & my_data$date == new_data$date[i])] = new_data$positive[i]
}
View(my_data)
# read in new county data
new_data = read_excel("DSHS New County Data.xlsx", col_names=T, n_max=10)
View(new_data)
# read in new county data
new_data = read_excel("DSHS New County Data.xlsx", col_names=T, n_max=9)
View(new_data)
my_data = read_excel("Texas COVID-19 Case Count Data by County.xlsx", skip=2, col_names=T, n_max=254)
library(stringr)
#DATE = paste0("2020",gsub(x=colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")], pattern="Cases\r\n|Cases\r\n\r\n|-", replacement=""))
DATE = paste0("2020",str_match(string=colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")], pattern="(\\d+-\\d+)")[,2])
DATE = gsub(x = DATE, pattern = "-", replacement = "")
colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")] = DATE
my_data = my_data[, -2]
colnames(my_data)[1] = "county"
my_data = as.data.frame(my_data)
library(reshape2)
my_data = melt(my_data)
colnames(my_data)[2:3] = c("date", "positive")
# read in new county data
new_data = read_excel("DSHS New County Data.xlsx", col_names=T, n_max=9)
DATE = seq(20200901,20200929,1)
colnames(new_data) = c("county", DATE)
new_data = melt(new_data)
colnames(new_data)[2:3] = c("date", "positive")
my_data$date = as.character(my_data$date)
new_data$date = as.character(new_data$date)
for(i in 1:nrow(new_data)){
my_data$positive[which(my_data$county == new_data$county[i] & my_data$date == new_data$date[i])] = new_data$positive[i]
}
View(new_data)
View(my_data)
my_data = read_excel("Texas COVID-19 Case Count Data by County.xlsx", skip=2, col_names=T, n_max=254)
library(stringr)
#DATE = paste0("2020",gsub(x=colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")], pattern="Cases\r\n|Cases\r\n\r\n|-", replacement=""))
DATE = paste0("2020",str_match(string=colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")], pattern="(\\d+-\\d+)")[,2])
DATE = gsub(x = DATE, pattern = "-", replacement = "")
colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")] = DATE
my_data = my_data[, -2]
colnames(my_data)[1] = "county"
my_data = as.data.frame(my_data)
library(reshape2)
my_data = melt(my_data)
colnames(my_data)[2:3] = c("date", "positive")
View(my_data)
View(new_data)
which(my_data$county == new_data$county[i] & my_data$date == new_data$date[i])
which(my_data$county == new_data$county[1] & my_data$date == new_data$date[1])
141354-140868
141353-140868
139682-139017
117568 - 116172
106595 - 105757
counties = unique(new_data$county)
i = 1
county = counties[i]
my_data_county = subset(my_data, my_data$county == county)
View(my_data_county)
my_data$county == county
my_data_county = my_data[which(my_data$county == county),]
View(my_data_county)
my_data_0831 = row.names(my_data_county)[which(my_data_county$date == "20200831")]
View(my_data_county)
my_data_0831 = which(my_data_county$date == "20200831")
my_data_county[178,]
my_data_county[177,]
205-177''
205-177
j = 1
my_data_county[my_data_0831+j-1, 3]
View(new_data)
new_data_county = new_data[which(new_data$county == county)]
new_data_county = new_data[which(new_data$county == county),]
View(new_data_county)
my_data = read_excel("Texas COVID-19 Case Count Data by County.xlsx", skip=2, col_names=T, n_max=254)
library(stringr)
#DATE = paste0("2020",gsub(x=colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")], pattern="Cases\r\n|Cases\r\n\r\n|-", replacement=""))
DATE = paste0("2020",str_match(string=colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")], pattern="(\\d+-\\d+)")[,2])
DATE = gsub(x = DATE, pattern = "-", replacement = "")
colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")] = DATE
my_data = my_data[, -2]
colnames(my_data)[1] = "county"
my_data = as.data.frame(my_data)
View(my_data)
new_data = read_excel("DSHS New County Data.xlsx", col_names=T, n_max=9)
DATE = seq(20200901,20200929,1)
colnames(new_data) = c("county", DATE)
View(new_data)
counties = unique(my_data$county)
View(my_data)
View(new_data)
county = counties[i]
my_data_county = my_data[which(my_data$county == county),]
View(my_data_county)
View(new_data)
new_data_county = new_data[which(new_data$county == county),]
View(new_data_county)
nrow(new_data_county)
my_data[county,]
my_data[which(my_data$county == county),]
my_data_county$20200929 == my_data_county$`20200928`
if(nrow(new_data_county) == 0){
my_data_county$20200929 == my_data_county$`20200928`
}
View(my_data_county)
if(nrow(new_data_county) == 0){
my_data_county$20200929 = my_data_county$`20200928`
}
if(nrow(new_data_county) == 0){
my_data_county$20200929 = my_data_county$`20200928`
}
if(nrow(new_data_county) == 0){
my_data_county$`20200929` = my_data_county$`20200928`
}
View(my_data_county)
counties
i = 8
county = counties[i]
my_data_county = my_data[which(my_data$county == county),]
new_data_county = new_data[which(new_data$county == county),]
View(new_data_county)
date = colnames(new_data_county[j])
j = 2
date = colnames(new_data_county[j])
my_data_county[,which(colnames(my_data_county) == date - 1)]
date = as.character(colnames(new_data_county[j]))
my_data_county[,which(colnames(my_data_county) == date - 1)]
my_data_county[,which(colnames(my_data_county) == (date - 1))]
date = colnames(new_data_county[j])
which(colnames(my_data_county) == date
}
}
my_data[which(my_data$county == county),] = my_data_county
}
library(reshape2)
my_data = melt(my_data)
colnames(my_data)[2:3] = c("date", "positive")
my_data = read_excel("Texas COVID-19 Case Count Data by County.xlsx", skip=2, col_names=T, n_max=254)
library(stringr)
#DATE = paste0("2020",gsub(x=colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")], pattern="Cases\r\n|Cases\r\n\r\n|-", replacement=""))
DATE = paste0("2020",str_match(string=colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")], pattern="(\\d+-\\d+)")[,2])
DATE = gsub(x = DATE, pattern = "-", replacement = "")
colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")] = DATE
my_data = my_data[, -2]
colnames(my_data)[1] = "county"
my_data = as.data.frame(my_data)
# read in new county data
new_data = read_excel("DSHS New County Data.xlsx", col_names=T, n_max=9)
DATE = seq(20200901,20200929,1)
colnames(new_data) = c("county", DATE)
counties = unique(my_data$county)
date = colnames(new_data_county[j])
which(colnames(my_data_county) == date
}
}
my_data[which(my_data$county == county),] = my_data_county
}
library(reshape2)
my_data = melt(my_data)
colnames(my_data)[2:3] = c("date", "positive")
my_data = read_excel("Texas COVID-19 Case Count Data by County.xlsx", skip=2, col_names=T, n_max=254)
library(stringr)
#DATE = paste0("2020",gsub(x=colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")], pattern="Cases\r\n|Cases\r\n\r\n|-", replacement=""))
DATE = paste0("2020",str_match(string=colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")], pattern="(\\d+-\\d+)")[,2])
DATE = gsub(x = DATE, pattern = "-", replacement = "")
colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")] = DATE
my_data = my_data[, -2]
colnames(my_data)[1] = "county"
my_data = as.data.frame(my_data)
# read in new county data
new_data = read_excel("DSHS New County Data.xlsx", col_names=T, n_max=9)
DATE = seq(20200901,20200929,1)
colnames(new_data) = c("county", DATE)
counties = unique(my_data$county)
which(colnames(my_data_county) == date
which(colnames(my_data_county) == date)
previous = current - 1
current = which(colnames(my_data_county) == date)
previous = current - 1
if(nrow(new_data_county) == 0){
my_data_county$`20200929` = my_data_county$`20200928`
} else {
for(j in 2:29){
date = colnames(new_data_county[j])
current = which(colnames(my_data_county) == date)
previous = current - 1
my_data_county[1,current] =  my_data_county[1,previous] + new_data_county[1,j]
}
my_data_county$`20200929` = my_data_county$`20200928` + new_data_county[1,30]
}
View(my_data)
View(my_data_county)
View(my_data_county)
my_data_county = my_data[which(my_data$county == county),]
View(my_data_county)
my_data_county = my_data[which(my_data$county == county),]
new_data_county = new_data[which(new_data$county == county),]
if(nrow(new_data_county) == 0){
my_data_county$`20200929` = my_data_county$`20200928`
} else {
for(j in 2:29){
date = colnames(new_data_county[j])
current = which(colnames(my_data_county) == date)
previous = current - 1
my_data_county[1,current] =  my_data_county[1,previous] + new_data_county[1,j]
}
my_data_county$`20200929` = my_data_county$`20200928` + new_data_county[1,30]
}
View(my_data_county)
my_data_county = my_data[which(my_data$county == county),]
new_data_county = new_data[which(new_data$county == county),]
if(nrow(new_data_county) == 0){
my_data_county$`20200929` = my_data_county$`20200928`
} else {
for(j in 2:29){
date = colnames(new_data_county[j])
current = which(colnames(my_data_county) == date)
previous = current - 1
my_data_county[1,current] =  my_data_county[1,previous] + new_data_county[1,j]
}
my_data_county$20200929 = my_data_county$`20200928` + new_data_county[1,30]
}
my_data_county = my_data[which(my_data$county == county),]
new_data_county = new_data[which(new_data$county == county),]
if(nrow(new_data_county) == 0){
my_data_county$`20200929` = my_data_county$`20200928`
}
View(my_data_county)
new_data_county[1,30]
new_data = as.data.frame(new_data)
my_data_county = my_data[which(my_data$county == county),]
new_data_county = new_data[which(new_data$county == county),]
if(nrow(new_data_county) == 0){
my_data_county$`20200929` = my_data_county$`20200928`
} else {
for(j in 2:29){
date = colnames(new_data_county[j])
current = which(colnames(my_data_county) == date)
previous = current - 1
my_data_county[1,current] =  my_data_county[1,previous] + new_data_county[1,j]
}
my_data_county$`20200929` = my_data_county$`20200928` + new_data_county[1,30]
}
View(my_data_county)
for(i in 1:length(counties)){
county = counties[i]
my_data_county = my_data[which(my_data$county == county),]
new_data_county = new_data[which(new_data$county == county),]
if(nrow(new_data_county) == 0){
my_data_county$`20200929` = my_data_county$`20200928`
} else {
for(j in 2:29){
date = colnames(new_data_county[j])
current = which(colnames(my_data_county) == date)
previous = current - 1
my_data_county[1,current] =  my_data_county[1,previous] + new_data_county[1,j]
}
my_data_county$`20200929` = my_data_county$`20200928` + new_data_county[1,30]
}
my_data[which(my_data$county == county),] = my_data_county
}
warnings()
View(my_data)
my_data = read_excel("Texas COVID-19 Case Count Data by County.xlsx", skip=2, col_names=T, n_max=254)
library(stringr)
#DATE = paste0("2020",gsub(x=colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")], pattern="Cases\r\n|Cases\r\n\r\n|-", replacement=""))
DATE = paste0("2020",str_match(string=colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")], pattern="(\\d+-\\d+)")[,2])
DATE = gsub(x = DATE, pattern = "-", replacement = "")
colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")] = DATE
my_data = my_data[, -2]
colnames(my_data)[1] = "county"
my_data = as.data.frame(my_data)
# read in new county data
new_data = read_excel("DSHS New County Data.xlsx", col_names=T, n_max=9)
DATE = seq(20200901,20200929,1)
colnames(new_data) = c("county", DATE)
new_data = as.data.frame(new_data)
counties = unique(my_data$county)
my_data$`20200929` = my_data$`20200928`
for(i in 1:length(counties)){
county = counties[i]
my_data_county = my_data[which(my_data$county == county),]
new_data_county = new_data[which(new_data$county == county),]
if(nrow(new_data_county) == 0){
next
} else {
for(j in 2:29){
date = colnames(new_data_county[j])
current = which(colnames(my_data_county) == date)
previous = current - 1
my_data_county[1,current] =  my_data_county[1,previous] + new_data_county[1,j]
}
my_data_county$`20200929` = my_data_county$`20200928` + new_data_county[1,30]
}
my_data[which(my_data$county == county),] = my_data_county
}
View(my_data_county)
View(my_data)
counties
i = 101
county = counties[i]
my_data_county = my_data[which(my_data$county == county),]
new_data_county = new_data[which(new_data$county == county),]
View(my_data_county)
View(new_data_county)
library(reshape2)
my_data = melt(my_data)
colnames(my_data)[2:3] = c("date", "positive")
View(my_data)
View(new_data)
counties
i = 146
county = counties[i]
my_data_county = my_data[which(my_data$county == county),]
new_data_county = new_data[which(new_data$county == county),]
View(new_data_county)
View(my_data_county)
my_data = read_excel("Texas COVID-19 Case Count Data by County.xlsx", skip=2, col_names=T, n_max=254)
library(stringr)
#DATE = paste0("2020",gsub(x=colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")], pattern="Cases\r\n|Cases\r\n\r\n|-", replacement=""))
DATE = paste0("2020",str_match(string=colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")], pattern="(\\d+-\\d+)")[,2])
DATE = gsub(x = DATE, pattern = "-", replacement = "")
colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")] = DATE
my_data = my_data[, -2]
colnames(my_data)[1] = "county"
my_data = as.data.frame(my_data)
# read in new county data
new_data = read_excel("DSHS New County Data.xlsx", col_names=T, n_max=9)
DATE = seq(20200901,20200929,1)
colnames(new_data) = c("county", DATE)
new_data = as.data.frame(new_data)
counties = unique(my_data$county)
my_data$`20200929` = my_data$`20200928`
county = counties[i]
my_data_county = my_data[which(my_data$county == county),]
new_data_county = new_data[which(new_data$county == county),]
View(my_data_county)
if(nrow(new_data_county) == 0){
next
} else {
for(j in 2:29){
date = colnames(new_data_county[j])
current = which(colnames(my_data_county) == date)
previous = current - 1
my_data_county[1,current] =  my_data_county[1,previous] + new_data_county[1,j]
}
my_data_county$`20200929` = my_data_county$`20200928` + new_data_county[1,30]
}
View(my_data_county)
county = counties[i]
my_data_county = my_data[which(my_data$county == county),]
new_data_county = new_data[which(new_data$county == county),]
if(nrow(new_data_county) == 0){
next
} else {
for(j in 2:29){
date = colnames(new_data_county[j])
current = which(colnames(my_data_county) == date)
previous = current - 1
my_data_county[1,current] =  my_data_county[1,previous] + new_data_county[1,j]
}
my_data_county$`20200929` = my_data_county$`20200928` + new_data_county[1,30]
}
View(my_data_county)
my_data = read_excel("Texas COVID-19 Case Count Data by County.xlsx", skip=2, col_names=T, n_max=254)
library(stringr)
#DATE = paste0("2020",gsub(x=colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")], pattern="Cases\r\n|Cases\r\n\r\n|-", replacement=""))
DATE = paste0("2020",str_match(string=colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")], pattern="(\\d+-\\d+)")[,2])
DATE = gsub(x = DATE, pattern = "-", replacement = "")
colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")] = DATE
my_data = my_data[, -2]
colnames(my_data)[1] = "county"
my_data = as.data.frame(my_data)
# read in new county data
new_data = read_excel("DSHS New County Data.xlsx", col_names=T, n_max=9)
DATE = seq(20200901,20200929,1)
colnames(new_data) = c("county", DATE)
new_data = as.data.frame(new_data)
counties = unique(my_data$county)
my_data$`20200929` = my_data$`20200928`
for(i in 1:length(counties)){
county = counties[i]
my_data_county = my_data[which(my_data$county == county),]
new_data_county = new_data[which(new_data$county == county),]
if(nrow(new_data_county) == 0){
next
} else {
for(j in 2:29){
date = colnames(new_data_county[j])
current = which(colnames(my_data_county) == date)
previous = current - 1
my_data_county[1,current] =  my_data_county[1,previous] + new_data_county[1,j]
}
my_data_county$`20200929` = my_data_county$`20200928` + new_data_county[1,30]
}
my_data[which(my_data$county == county),] = my_data_county
}
library(reshape2)
my_data = melt(my_data)
colnames(my_data)[2:3] = c("date", "positive")
write.table(x=my_data, file="covid_19_positive.txt", quote=F, sep="\t", row.names=F)
rm(list=ls())
library("readxl")
#setwd("/usr/share/httpd/covid-19-county-R0/TSHS_CaseCountData/")
my_data = read_excel("Texas COVID-19 Case Count Data by County.xlsx", skip=2, col_names=T, n_max=254)
library(stringr)
#DATE = paste0("2020",gsub(x=colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")], pattern="Cases\r\n|Cases\r\n\r\n|-", replacement=""))
DATE = paste0("2020",str_match(string=colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")], pattern="(\\d+-\\d+)")[,2])
DATE = gsub(x = DATE, pattern = "-", replacement = "")
colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")] = DATE
my_data = my_data[, -2]
colnames(my_data)[1] = "county"
my_data = as.data.frame(my_data)
# read new county data
new_data = read_excel("DSHS New County Data.xlsx", col_names=T, n_max=9)
new_data_date = seq(20200901,20200929,1)
colnames(new_data) = c("county", new_data_date)
new_data = as.data.frame(new_data)
counties = unique(my_data$county)
my_data$`20200929` = my_data$`20200928`
for(i in 1:length(counties)){
county = counties[i]
my_data_county = my_data[which(my_data$county == county),]
new_data_county = new_data[which(new_data$county == county),]
if(nrow(new_data_county) == 0){
next
} else {
for(j in 2:29){
date = colnames(new_data_county[j])
current = which(colnames(my_data_county) == date)
previous = current - 1
my_data_county[1,current] =  my_data_county[1,previous] + new_data_county[1,j]
}
my_data_county$`20200929` = my_data_county$`20200928` + new_data_county[1,30]
}
my_data[which(my_data$county == county),] = my_data_county
}
library(reshape2)
my_data = melt(my_data)
colnames(my_data)[2:3] = c("date", "positive")
View(my_data)
rm(list=ls())
library("readxl")
#setwd("/usr/share/httpd/covid-19-county-R0/TSHS_CaseCountData/")
my_data = read_excel("Texas COVID-19 Case Count Data by County.xlsx", skip=2, col_names=T, n_max=254)
library(stringr)
#DATE = paste0("2020",gsub(x=colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")], pattern="Cases\r\n|Cases\r\n\r\n|-", replacement=""))
DATE = paste0("2020",str_match(string=colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")], pattern="(\\d+-\\d+)")[,2])
DATE = gsub(x = DATE, pattern = "-", replacement = "")
colnames(my_data)[grep(x=colnames(my_data), pattern="Cases")] = DATE
my_data = my_data[, -2]
colnames(my_data)[1] = "county"
my_data = as.data.frame(my_data)
# read new county data
new_data = read_excel("DSHS New County Data.xlsx", col_names=T, n_max=9)
new_data_date = seq(20200901,20200929,1)
colnames(new_data) = c("county", new_data_date)
new_data = as.data.frame(new_data)
counties = unique(my_data$county)
my_data$`20200929` = my_data$`20200928`
for(i in 1:length(counties)){
county = counties[i]
my_data_county = my_data[which(my_data$county == county),]
new_data_county = new_data[which(new_data$county == county),]
if(nrow(new_data_county) == 0){
next
} else {
for(j in 2:29){
date = colnames(new_data_county[j])
current = which(colnames(my_data_county) == date)
previous = current - 1
my_data_county[1,current] =  my_data_county[1,previous] + new_data_county[1,j]
}
my_data_county$`20200929` = my_data_county$`20200928` + new_data_county[1,30]
}
my_data[which(my_data$county == county),] = my_data_county
}
library(reshape2)
my_data = melt(my_data)
colnames(my_data)[2:3] = c("date", "positive")
write.table(x=my_data, file="covid_19_positive.txt", quote=F, sep="\t", row.names=F)
